<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>深拷贝与浅拷贝的实现及区别 | Fog3211</title>
    <meta name="description" content="深拷贝与浅拷贝的实现及区别">
    <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico">
  <link rel="manifest" href="/manifest.json">
    <meta name="keywords" content="深拷贝, 浅拷贝, javaScript">
    <link rel="preload" href="/assets/css/0.styles.cdd2a29b.css" as="style"><link rel="preload" href="/assets/js/app.20bb5225.js" as="script"><link rel="preload" href="/assets/js/44.0ea4214a.js" as="script"><link rel="prefetch" href="/assets/js/10.8a9c4f08.js"><link rel="prefetch" href="/assets/js/11.8783f7cc.js"><link rel="prefetch" href="/assets/js/12.5ba97642.js"><link rel="prefetch" href="/assets/js/13.1555b7ad.js"><link rel="prefetch" href="/assets/js/14.86f2088d.js"><link rel="prefetch" href="/assets/js/15.fe266707.js"><link rel="prefetch" href="/assets/js/16.15fb79aa.js"><link rel="prefetch" href="/assets/js/17.1a463419.js"><link rel="prefetch" href="/assets/js/18.7c246c5a.js"><link rel="prefetch" href="/assets/js/19.61ef187a.js"><link rel="prefetch" href="/assets/js/2.81a45b37.js"><link rel="prefetch" href="/assets/js/20.7a9b2f72.js"><link rel="prefetch" href="/assets/js/21.b4f5ca00.js"><link rel="prefetch" href="/assets/js/22.3f4573be.js"><link rel="prefetch" href="/assets/js/23.e2af9378.js"><link rel="prefetch" href="/assets/js/24.785952aa.js"><link rel="prefetch" href="/assets/js/25.7ae5ad53.js"><link rel="prefetch" href="/assets/js/26.36e42edb.js"><link rel="prefetch" href="/assets/js/27.3409191d.js"><link rel="prefetch" href="/assets/js/28.393153e4.js"><link rel="prefetch" href="/assets/js/29.dfc25383.js"><link rel="prefetch" href="/assets/js/3.c6d0cc46.js"><link rel="prefetch" href="/assets/js/30.71df5033.js"><link rel="prefetch" href="/assets/js/31.df5404b7.js"><link rel="prefetch" href="/assets/js/32.f1e5ef7c.js"><link rel="prefetch" href="/assets/js/33.3a7e0b72.js"><link rel="prefetch" href="/assets/js/34.bad16bb7.js"><link rel="prefetch" href="/assets/js/35.70e4cf71.js"><link rel="prefetch" href="/assets/js/36.121c4657.js"><link rel="prefetch" href="/assets/js/37.bf6ac364.js"><link rel="prefetch" href="/assets/js/38.fc37e97c.js"><link rel="prefetch" href="/assets/js/39.d04e3ead.js"><link rel="prefetch" href="/assets/js/4.bc59a004.js"><link rel="prefetch" href="/assets/js/40.6a269460.js"><link rel="prefetch" href="/assets/js/41.2ac7fb97.js"><link rel="prefetch" href="/assets/js/42.73ab3bd7.js"><link rel="prefetch" href="/assets/js/43.f9273bf5.js"><link rel="prefetch" href="/assets/js/45.eb95c47a.js"><link rel="prefetch" href="/assets/js/46.e5a1623a.js"><link rel="prefetch" href="/assets/js/47.3ae1611c.js"><link rel="prefetch" href="/assets/js/48.da7834c4.js"><link rel="prefetch" href="/assets/js/49.cf1add44.js"><link rel="prefetch" href="/assets/js/5.1cecc36c.js"><link rel="prefetch" href="/assets/js/50.7d5dfb82.js"><link rel="prefetch" href="/assets/js/51.16da791b.js"><link rel="prefetch" href="/assets/js/52.23ddb970.js"><link rel="prefetch" href="/assets/js/53.2de2eea4.js"><link rel="prefetch" href="/assets/js/54.c02fc9ea.js"><link rel="prefetch" href="/assets/js/55.b391fb5b.js"><link rel="prefetch" href="/assets/js/56.0c72f5c7.js"><link rel="prefetch" href="/assets/js/57.22a17b28.js"><link rel="prefetch" href="/assets/js/58.533c918b.js"><link rel="prefetch" href="/assets/js/59.96ac7904.js"><link rel="prefetch" href="/assets/js/6.7fdb8414.js"><link rel="prefetch" href="/assets/js/60.4e089b8c.js"><link rel="prefetch" href="/assets/js/61.7b17150b.js"><link rel="prefetch" href="/assets/js/62.937e58de.js"><link rel="prefetch" href="/assets/js/63.cb70c672.js"><link rel="prefetch" href="/assets/js/7.f5fab6ae.js"><link rel="prefetch" href="/assets/js/8.770acd1e.js"><link rel="prefetch" href="/assets/js/9.93643764.js">
    <link rel="stylesheet" href="/assets/css/0.styles.cdd2a29b.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div><div class="wrap"><div class="theme-container container no-sidebar"><header class="navbar"><div class="nav-header"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/head.png" class="logo"> <span class="site-name can-hide">
        Fog3211
      </span></a> <nav class="nav-links can-hide"><div class="nav-item"><a href="/blog/" class="nav-link router-link-active">文章</a></div><div class="nav-item"><a href="/resume/" class="nav-link">简历</a></div><div class="nav-item"><a href="/tags/" class="nav-link">标签</a></div><div class="nav-item"><a href="https://github.com/fog3211" target="_blank" rel="noopener noreferrer" class="nav-link">Github</a></div> <!----></nav> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div></div></div></header> <div class="sidebar-mask"></div> <div class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/blog/" class="nav-link router-link-active">文章</a></div><div class="nav-item"><a href="/resume/" class="nav-link">简历</a></div><div class="nav-item"><a href="/tags/" class="nav-link">标签</a></div><div class="nav-item"><a href="https://github.com/fog3211" target="_blank" rel="noopener noreferrer" class="nav-link">Github</a></div> <!----></nav> <!----></div> <div class="page-container"><div><div class="page card"><div class="content-header"><h1 class="page-title">
        深拷贝与浅拷贝的实现及区别
      </h1> <span class="page-timestamp">2019-04-11 22:16:56</span></div> <div class="content"><p>本文将介绍js中深拷贝与浅拷贝的实现及区别。
</p> <h2 id="介绍"><a href="#介绍" aria-hidden="true" class="header-anchor">#</a> 介绍</h2> <p>    在学习js初期阶段，一般的新手会使用直接赋值的方式拷贝对象或数组，这往往会发生意想不到的效果，因为对于数组，对象包括函数一类的变量都是引用类型的，直接赋值只能做到浅拷贝，下面我就来介绍一下深拷贝与浅拷贝的区别及用法。</p> <h2 id="正文"><a href="#正文" aria-hidden="true" class="header-anchor">#</a> 正文</h2> <h3 id="概念"><a href="#概念" aria-hidden="true" class="header-anchor">#</a> 概念</h3> <p>    什么是深拷贝？什么又是浅拷贝？<br>
首先，要明确的就是js中的数据类型分为基本数据类型（boolen，number，string，null，undefined，symbol，BigInt）和引用类型（function，array，object）。对于浅拷贝与深拷贝也是仅相对引用类型而言的（因为拷贝函数的意义不大，这里不做讨论）。<br>
总结来说就是：</p> <h4 id="深拷贝"><a href="#深拷贝" aria-hidden="true" class="header-anchor">#</a> 深拷贝</h4> <p>创建了一个新的数组或对象，每一项都是独立的。</p> <h4 id="浅拷贝"><a href="#浅拷贝" aria-hidden="true" class="header-anchor">#</a> 浅拷贝</h4> <p>复制的只是原数组或对象的引用，相当于指针指向了原对象或数组的地址，实际上并没有完全脱离原对象。</p> <h3 id="原理分析"><a href="#原理分析" aria-hidden="true" class="header-anchor">#</a> 原理分析</h3> <p>对于基本数据类型，它的键和值都是存放在栈内存中的，直接复制的话是会新开一个栈内存存放一个新的数据。<br> <img src="https://img.fog3211.com/J~%7BI%5DKPIUVR98L%5D%7B3%5B2QM4.png" alt="avatar"><br>
而对于引用数据类型，它的键是保存在栈内存，值保存在堆内存中，（当然为了把他们联系起来栈内存中还会保存堆内存的地址以便于值的寻找）。因为考虑到引用数据类型的数据可能较多，直接复制会浪费大量内存，于是它的复制是这样的。
<img src="https://img.fog3211.com/XJVECC%25D~%60NRX%7D8@RYD4ZOG.png" alt="avatar"><br>
理解了这一点就可以知道，如果我们直接修改arr2的值，arr1也会改变（因为它们指向的是同一个东西）。</p> <p>对于对象和数组，一般的复制都是希望复制后的与复制前的是独立的，也就是深拷贝。下面就来介绍几种常用的深拷贝方法。</p> <h3 id="数组深拷贝的实现"><a href="#数组深拷贝的实现" aria-hidden="true" class="header-anchor">#</a> 数组深拷贝的实现</h3> <h4 id="直接遍历"><a href="#直接遍历" aria-hidden="true" class="header-anchor">#</a> 直接遍历</h4> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">let</span> arr<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> brr<span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">let</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span>arr<span class="token punctuation">.</span>length<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  brr<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">=</span>arr<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>brr<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//打印[1,2,3,4,5]</span>
</code></pre></div><h4 id="slice"><a href="#slice" aria-hidden="true" class="header-anchor">#</a> slice()</h4> <p>当slice()不带任何参数的时候，默认返回一个长度和原数组相同的新数组。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">let</span> arr<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> brr<span class="token operator">=</span>arr<span class="token punctuation">.</span><span class="token function">slice</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>brr<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//打印[1,2,3,4,5]</span>
</code></pre></div><h4 id="concat"><a href="#concat" aria-hidden="true" class="header-anchor">#</a> concat()</h4> <p>与slice类似，只不过这个是相当于把原数组和一个[]相接返回的新数组。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">let</span> arr<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> brr<span class="token operator">=</span>arr<span class="token punctuation">.</span><span class="token function">concat</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>brr<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//打印[1,2,3,4,5]</span>
</code></pre></div><div class="warning custom-block"><p class="custom-block-title">WARNING</p> <p>对于简单数组的拷贝以上做法是没问题的，但是如果数组比较复杂（数组的每一项可能是引用类型），就治标不治本了，因为上面的方法本质还是直接赋值，只不过是从数组-&gt;数组的项的转变。如</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">let</span> arr<span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> brr<span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">let</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span>arr<span class="token punctuation">.</span>length<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  brr<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">=</span>arr<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
brr<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token number">100</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>arr<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//[[100,1],2,3,4,5]</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>brr<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//[[100,1],2,3,4,5]</span>
</code></pre></div></div> <h3 id="对象深拷贝的实现"><a href="#对象深拷贝的实现" aria-hidden="true" class="header-anchor">#</a> 对象深拷贝的实现</h3> <h4 id="直接遍历-2"><a href="#直接遍历-2" aria-hidden="true" class="header-anchor">#</a> 直接遍历</h4> <p>与数组遍历类似，没什么好说的</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">let</span> obj1<span class="token operator">=</span><span class="token punctuation">{</span>
  a<span class="token punctuation">:</span><span class="token number">1</span><span class="token punctuation">,</span>
  b<span class="token punctuation">:</span><span class="token number">2</span><span class="token punctuation">,</span>
  c<span class="token punctuation">:</span><span class="token number">3</span>
<span class="token punctuation">}</span>
<span class="token keyword">let</span> obj2<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token keyword">in</span> obj1<span class="token punctuation">)</span><span class="token punctuation">{</span>
  obj2<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">=</span>obj1<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>obj2<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//{a: 1, b: 2, c: 3}</span>
</code></pre></div><h4 id="es6扩展运算符"><a href="#es6扩展运算符" aria-hidden="true" class="header-anchor">#</a> ES6扩展运算符</h4> <p>ES6的扩展运算符其实就是直接遍历的语法糖，自动扩展并遍历对象的所有属性，实质没什么区别，简化操作而已。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">let</span> obj1<span class="token operator">=</span><span class="token punctuation">{</span>
  a<span class="token punctuation">:</span><span class="token number">1</span><span class="token punctuation">,</span>
  b<span class="token punctuation">:</span><span class="token number">2</span><span class="token punctuation">,</span>
  c<span class="token punctuation">:</span><span class="token number">3</span>
<span class="token punctuation">}</span>
<span class="token keyword">let</span> obj2<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
obj2<span class="token operator">=</span><span class="token punctuation">{</span><span class="token operator">...</span>obj1<span class="token punctuation">}</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>obj2<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//{a: 1, b: 2, c: 3}</span>
</code></pre></div><h4 id="es6的object-assign"><a href="#es6的object-assign" aria-hidden="true" class="header-anchor">#</a> ES6的Object.assign</h4> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">let</span> obj1<span class="token operator">=</span><span class="token punctuation">{</span>
  a<span class="token punctuation">:</span><span class="token number">1</span><span class="token punctuation">,</span>
  b<span class="token punctuation">:</span><span class="token number">2</span><span class="token punctuation">,</span>
  c<span class="token punctuation">:</span><span class="token number">3</span>
<span class="token punctuation">}</span>
<span class="token keyword">let</span> obj2<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
obj2<span class="token operator">=</span>Object<span class="token punctuation">.</span><span class="token function">assign</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> obj1<span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>obj2<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//{a: 1, b: 2, c: 3}</span>
</code></pre></div><p>虽然以上几种方法可以实现对象的简单拷贝，但与数组一样，这些方法只对简单对象起作用。如</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">let</span> obj1<span class="token operator">=</span><span class="token punctuation">{</span>
  a<span class="token punctuation">:</span><span class="token punctuation">{</span>
    aa1<span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">,</span>
    aa2<span class="token punctuation">:</span><span class="token number">1</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  b<span class="token punctuation">:</span><span class="token number">2</span><span class="token punctuation">,</span>
  c<span class="token punctuation">:</span><span class="token number">3</span>
<span class="token punctuation">}</span>
<span class="token keyword">let</span> obj2<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
obj2<span class="token operator">=</span>Object<span class="token punctuation">.</span><span class="token function">assign</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> obj1<span class="token punctuation">)</span><span class="token punctuation">;</span>
obj2<span class="token punctuation">.</span>a<span class="token punctuation">.</span>aa1<span class="token operator">=</span><span class="token number">100</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>obj1<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//{a: {aa1:100,aa2:1}, b: 2, c: 3}</span>
</code></pre></div><h3 id="通用解决方案"><a href="#通用解决方案" aria-hidden="true" class="header-anchor">#</a> 通用解决方案</h3> <p>介绍了那么多，居然没一个好用的？对于复杂的数组或对象我们就无能为力了吗？当然不是——我们还有大招。</p> <h4 id="递归遍历"><a href="#递归遍历" aria-hidden="true" class="header-anchor">#</a> 递归遍历</h4> <p>对于普通的遍历往往不能够全面的复制引用数据类型，那么我们就用递归来实现以下吧。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">deepCopy</span><span class="token punctuation">(</span><span class="token parameter">obj</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 处理null情况</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>obj<span class="token punctuation">)</span> <span class="token punctuation">{</span>
     <span class="token keyword">return</span> newobj <span class="token operator">=</span> obj<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
   <span class="token keyword">let</span> newobj <span class="token operator">=</span> obj<span class="token punctuation">.</span>constructor <span class="token operator">===</span> Array <span class="token operator">?</span> <span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> obj <span class="token operator">!==</span> <span class="token string">'object'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      newobj <span class="token operator">=</span> obj<span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
      <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token keyword">in</span> obj<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        newobj<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">typeof</span> obj<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">===</span> <span class="token string">'object'</span> <span class="token operator">?</span>
        <span class="token function">deepCopy</span><span class="token punctuation">(</span>obj<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">:</span> obj<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> newobj<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
</code></pre></div><h4 id="json-parse-json-stringify"><a href="#json-parse-json-stringify" aria-hidden="true" class="header-anchor">#</a> JSON.parse(JSON.stringify())</h4> <p>该方法应该是最简单最高效的方法了，利用JSON将数据转为字符串，然后再从字符串中取出数组或对象。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 复杂对象数组</span>
<span class="token keyword">let</span> arr <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">{</span> a<span class="token punctuation">:</span> <span class="token number">1</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> b<span class="token punctuation">:</span> <span class="token number">2</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> c<span class="token punctuation">:</span> <span class="token number">3</span><span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> brr <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
brr<span class="token operator">=</span><span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span><span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>arr<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
brr<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>a<span class="token operator">=</span><span class="token number">100</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>arr<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//[{a:1},{b:2},{c:3}]</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>brr<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//[{a:100},{b:2},{c:3}]</span>

<span class="token comment">// 复杂数组对象</span>
<span class="token keyword">let</span> obj1 <span class="token operator">=</span> <span class="token punctuation">{</span>
  a<span class="token punctuation">:</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  b<span class="token punctuation">:</span><span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> obj2 <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
obj2<span class="token operator">=</span><span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span><span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>obj1<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
obj2<span class="token punctuation">.</span>a<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token number">100</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>obj2<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//{a:[100,1,2],b:[3,4,5]}</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>obj1<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//{a:[0,1,2],b:[3,4,5]}</span>
</code></pre></div><p>可以看出以上两种方法都是可以完美满足我们的需求的。</p> <h2 id="总结"><a href="#总结" aria-hidden="true" class="header-anchor">#</a> 总结</h2> <p>    对于简单的引用数据类型复制，我们可以用简单遍历或一下基本语法糖完成，但一定要保证拷贝的数据只有一层，否则就需要使用递归遍历或者JSON进行复制。<br>
需要注意的是，引用类型的复制会消耗大量内存，如何选择需要依据实际情况而定。</p></div> <!----> <div class="content page-nav"><p class="inner"><span class="prev">
          ← <a href="/blog/learn-lottie.html" class="prev">
            Lottie制作web动画学习记录
          </a></span> <span class="next"><a href="/blog/mpvue-mini-apps.html">
            mpvue开发小程序踩坑记录
          </a> →
        </span></p></div></div> <div id="comment-container"><div class="gt-container"><div class="gt-initing"><i class="gt-loader"></i> <p class="gt-initing-text">Gitalking ...</p></div> <!----> <!----> <div><div class="gt-header"><a class="gt-avatar-github"><span class="gt-ico gt-ico-github"><span class="gt-svg"><svg viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg">
  <path d="M64 524C64 719.602 189.356 885.926 364.113 947.017 387.65799 953 384 936.115 384 924.767L384 847.107C248.118 863.007 242.674 773.052 233.5 758.001 215 726.501 171.5 718.501 184.5 703.501 215.5 687.501 247 707.501 283.5 761.501 309.956 800.642 361.366 794.075 387.658 787.497 393.403 763.997 405.637 743.042 422.353 726.638 281.774 701.609 223 615.67 223 513.5 223 464.053 239.322 418.406 271.465 381.627 251.142 320.928 273.421 269.19 276.337 261.415 334.458 256.131 394.888 302.993 399.549 306.685 432.663 297.835 470.341 293 512.5 293 554.924 293 592.81 297.896 626.075 306.853 637.426 298.219 693.46 258.054 747.5 262.966 750.382 270.652 772.185 321.292 753.058 381.083 785.516 417.956 802 463.809 802 513.5 802 615.874 742.99 701.953 601.803 726.786 625.381 750.003 640 782.295 640 818.008L640 930.653C640.752 939.626 640 948.664978 655.086 948.665 832.344 888.962 960 721.389 960 524 960 276.576 759.424 76 512 76 264.577 76 64 276.576 64 524Z"></path>
</svg>
</span> <!----></span></a> <div class="gt-header-comment"><textarea placeholder="Leave a comment" class="gt-header-textarea"></textarea> <div class="gt-header-preview markdown-body hide"></div> <div class="gt-header-controls"><a href="https://guides.github.com/features/mastering-markdown/" target="_blank" class="gt-header-controls-tip"><span class="gt-ico gt-ico-tip"><span class="gt-svg"><svg viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg">
  <path d="M512 366.949535c-16.065554 0-29.982212 13.405016-29.982212 29.879884l0 359.070251c0 16.167882 13.405016 29.879884 29.982212 29.879884 15.963226 0 29.879884-13.405016 29.879884-29.879884L541.879884 396.829419C541.879884 380.763865 528.474868 366.949535 512 366.949535L512 366.949535z"
    p-id="3083"></path>
  <path d="M482.017788 287.645048c0-7.776956 3.274508-15.553912 8.80024-21.181973 5.525732-5.525732 13.302688-8.80024 21.181973-8.80024 7.776956 0 15.553912 3.274508 21.079644 8.80024 5.525732 5.62806 8.80024 13.405016 8.80024 21.181973 0 7.776956-3.274508 15.656241-8.80024 21.181973-5.525732 5.525732-13.405016 8.697911-21.079644 8.697911-7.879285 0-15.656241-3.274508-21.181973-8.697911C485.292295 303.301289 482.017788 295.524333 482.017788 287.645048L482.017788 287.645048z"
    p-id="3084"></path>
  <path d="M512 946.844409c-239.8577 0-434.895573-195.037873-434.895573-434.895573 0-239.8577 195.037873-434.895573 434.895573-434.895573 239.755371 0 434.895573 195.037873 434.895573 434.895573C946.895573 751.806535 751.755371 946.844409 512 946.844409zM512 126.17088c-212.740682 0-385.880284 173.037274-385.880284 385.777955 0 212.740682 173.037274 385.777955 385.880284 385.777955 212.740682 0 385.777955-173.037274 385.777955-385.777955C897.777955 299.208154 724.740682 126.17088 512 126.17088z"
    p-id="3085"></path>
</svg>
</span> <span class="gt-ico-text">Markdown is supported</span></span></a> <!----> <button class="gt-btn gt-btn-preview"><span class="gt-btn-text">Preview</span> <!----></button> <button class="gt-btn gt-btn-login"><span class="gt-btn-text">Login with GitHub</span> <!----></button></div></div></div> <div class="gt-comments"><span></span> <p class="gt-comments-null">
                Be the first guy leaving a comment!
            </p> <!----></div></div></div></div></div> <!----></div> <div class="tool-group"><!----></div></div> <!----></div> <div class="background-mask" style="background:#f6f6f6;"></div></div></div>
    <script src="/assets/js/app.20bb5225.js" defer></script><script src="/assets/js/44.0ea4214a.js" defer></script>
  </body>
</html>
